{% extends 'decisions/base.html' %}
{% load static account socialaccount bootstrap i18n module_tags %}
{% block title %}{% block h1 %}Success terms
{% endblock %}{% endblock %}
{% block content %}
    <style type="text/css">
        #why_options div {
            margin-bottom: 10px;
        }

        label {
            font-size: large;
            border: 1px solid #dddddd;
            width: 100%;
            padding: 5px;
        }

        :checked + span {
            font-weight: bold;
        }

    .explanation {
        display: none;
        font-size: 0.8em;
        padding-top: 5px;
        visibility: hidden;
    }
    </style>
    <h2 class="center">Success terms</h2>

    <h3>What are you solving for?</h3>
    <p style="border-bottom: 1px solid black;"><strong>{{ module.dd_as_question }}</strong></p>
    <p>Picture that youâ€™ve already made the decision and its successful. How do you feel?</p>

    <p>Select all the success phrases that apply. I want to feel:</p>

    <div id="why_options">
        {% for value in module.get_success_terms %}
            <div>
                <label>
                    {% if value.phrase in success_terms %}
                    <input type="checkbox" name="success_terms[]" value="{{ value.phrase }}" checked="checked"/>
                    <span>{{ value.question }}</span>
                    <span class="explanation" style="display: block; visibility: visible;">{{ value.explanation }}</span>
                    {% else %}
                    <input type="checkbox" name="success_terms[]" value="{{ value.phrase }}"/>
                    <span>{{ value.question }}</span>
                    <span class="explanation">{{ value.explanation }}</span>
                    {% endif %}
                </label>
            </div>
        {% endfor %}
    </div>

    {% get_next_btn module "Terms Defined!" nav.nextUrl "submit" %}
    {% get_back_link module nav.previousUrl %}

    <script type="text/javascript">
        $(document).ready(function () {
            $('#next').click(validate);
            $("input:checkbox[name='success_terms[]']").click(showExplanation);
        });

        function showExplanation() {
            var checked = $(this).prop('checked');
            var explanation = $(this).next().next();
            var current = explanation.css('display');
            if (current == 'none') {
                explanation.css('display', 'block').css('visibility', 'visible');
            } else {
                explanation.css('display', 'none').css('visibility', 'hidden');
            }
        }

        function validate() {
            var correctTotal = 3;
            var correct = 0;
            var incorrect = 0;
            var error_msg = "";

            $("input:checkbox[name='success_terms[]']").each(function() {
                if ($(this).prop('checked')) {
                    if ($(this).val() == 1) {
                        correct++;
                    } else {
                        incorrect++;
                        console.log($(this));
                    }
                }
            });

            return true;
        }
    </script>
{% endblock %}